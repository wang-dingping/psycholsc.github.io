---
layout: post
comments: true
title:  "自适应滤波器"
excerpt: "-"
date:   2019-03-13 12:42:24 +0000
categories: Notes
---

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
---

## 自适应滤波器基础

自适应滤波的基本原理是，设计一个参数可调的滤波器（例如FIR横向滤波器），然后设计自适应算法，根据目的信号和输出信号之间的差值的某种函数关系，最小化这个目标函数以达到误差最小化，调整可调系数。

因为在环境中可以自行调整参数的变化，因此我们说这时一种自适应算法、自适应滤波器。

首先可实现的数字滤波器我们一般认为有两类，即`IIR`滤波器和`FIR`数字滤波器

两类滤波器得名都是因为其结构特点的，由于`IIR`存在较为复杂的反馈结构，使其能够产生无限长的响应，而同理，由于`FIR`滤波器并没有反馈结构，因此并不能产生无限长的响应。这两类滤波器的结构都是固定的，其中的参数也是经过设计得到的

`IIR Filter`
$$
\begin{equation}
\begin{split}
H(z)=\frac{\sum\limits_{k=0}^Mb_kz^{-k}}{1-\sum\limits_{k=1}^Ma_kz^{-k}}
\end{split}
\tag{1}
\end{equation}
$$

可以看出是存在反馈结构的。这里引用一段其他地方的定义，`IIR`滤波器也被称为**递归**滤波器，从命名来看就是针对含有反馈结构的。我们常说这两类滤波器很大程度上是因为这两种滤波器可以写出封闭函数结构，其中`IIR`滤波器由于采用反馈电路设计，会导致误差不断积累而产生寄生振荡。这两类滤波器设计都可以参考成熟的模拟滤波器设计原理。不过由于`IIR`滤波器的相位特性比较难以控制，一般在宽频带内需要相位校准网络进行相位校准。

`FIR Filter`
$$
\begin{equation}
\begin{split}
H(z)=\sum\limits_{k=0}^Mb_kz^{-k}
\end{split}
\tag{2}
\end{equation}
$$
这是有限长度单位冲激响应的滤波器，一看就是一个线性延迟组合的结构，是非递归结构。`FIR`滤波器设计可以充分考虑到相位的问题，因此很有利于设计线性相位的滤波器，这一点十分优秀。而由于不存在递归结构，因此响应长度有限，也不会出现`IIR`那样的误差响应积累效应。处理信号的时候，往往就是一个模数转换器，对信号采样后送入延迟单元入口，后面就是`FIR`的处理了。

但是如果处理自适应问题，仅仅是这样的非时变滤波器往往是不能满足要求的，因为在我们处理的时候，不同场景往往需要不同的滤波器。比如在移动通信中，信道是时刻变化的，对于这种情况，我们的数字滤波器必须能够处理所有情况的问题，因此设计自适应滤波器就可以解决已知或未知信道的问题。

这是一种时变滤波器。

---

所谓**自适应滤波**，就是根据预先确定的性能准则，设计结构预算法，实现参数自适应调整的滤波器。这种滤波器并没有明确的设计规范，但是一定会要求期望或参考信号。一般来说框图可以这样表示

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/AF.png" style="display: inline-block;" width="500"/>
</div>

对于输入信号$$x(k)$$，我们滤波后得到输出$$y(k)$$，通过与误差信号进行比较后反馈差异，利用该结果 实现参数自适应调整。首先是自适应信号处理的三个基本要素

- 应用
    - 根据具体环境选取输入信号与期望信号
- 自适应滤波器结构
    - `IIR`，实现、分析简单，有极点
    - `FIR`，全零点无反馈有唯一最优解
- 算法
    - 实现预先确定的目标函数的最小化
    - 采用搜索算法或者其他优化方法；目标函数和误差信号的特点也能计算。

另外对于自适应算法，也有三个重要要素

- 最小化算法
    - 牛顿法，需要计算逆矩阵，该操作较慢。但是收敛快。
    - 准牛顿法，估计逆矩阵。
    - 梯度下降法，利用梯度搜索最优解。计算最为简单。
- 目标函数形式
    - 均方误差（`MSE`）
    - 最小二乘（`LS`）
    - 加权最小二乘（`WLS`）
    - 瞬时平方值（`ISV`）
- 误差信号表示
    - 这有很多种，会影响到计算复杂度、收敛速度以及鲁棒性等。

简单说一下应用。自适应滤波常见应用是，**系统辨识**、**信道均衡**、**信号增强**、**信号预测**。

## 维纳滤波器

维纳滤波器是本课程中介绍的第一个重要的自适应滤波器，命名大约是因为其提出者的名字，`Norbert Wiener`。这个是上世纪四十年代末提出的一种自适应滤波器，其优化准则是**最小化均方误差**。是一种线性滤波器（实际上就常常采用`FIR`结构实现）。首先我们介绍两种简单的滤波器结构，由于是本科生课程，此处只研究到线性滤波器的简单实现。

**1. 线性组合器**

线性组合器就是按照不同权重将不同信号进行线性加权的设备。实在是不想解释了。根据其计算特点，输出可以表示为



$$
\begin{equation}
\begin{split}
y(k)=w^T(k)x(k)
\end{split}
\tag{3}
\end{equation}
$$


这里$$x(k)$$是不同信号

**2. FIR横向滤波器**

嘿呀这个好像也没什么说的必要。横向滤波器的结构有机会的话这里补一张图说明一下。实际上是同一个信号的不同延迟送入线性组合器中，写成表达式也是


$$
\begin{equation}
\begin{split}
y(k)=w^T(k)x(k)
\end{split}
\tag{4}
\end{equation}
$$


这里的$$x(k)$$是同一信号的不同延迟。

---



然后此处介绍信号的相关矩阵。信号的相关矩阵一般定义为



$$
\begin{equation}
\begin{split}
R=E \left[ XX^H \right]
\end{split}
\tag{5}
\end{equation}
$$



出来是一个矩阵。该矩阵是一个半正定矩阵，且是一个厄米特矩阵，满足共轭转置等于自身。

关于特征值和特征向量，这里给出解释（参考资料为同济大学《线性代数》）

- 如果满秩矩阵$$R$$特征值是$$\lambda_i$$，那么必然存在以下关系


    $$
    \begin{equation}
    \begin{split}
    
    diag\{ \lambda_i \}=\Lambda=P^{-1}AP
    
    \end{split}
    \tag{6}
    \end{equation}
    $$


    一定能找到一个矩阵$$P$$使上式成立，这个矩阵正是按特征值顺序排列的特征向量。

- 二次型

  
    $$
    \begin{equation}
    \begin{split}
    
    f(x)=x^T Ax
    
    \end{split}
    \tag{7}
    \end{equation}
    $$
    

    假如此时$$x=Cy$$，那么

    
    $$
    \begin{equation}
    \begin{split}
    
    f(x)=y^TC^T A Cy=y^T \Lambda y
    
    \end{split}
    \tag{8}
    \end{equation}
    $$
    

    若$$A$$是一个对角阵，则$$C$$是一个正交矩阵，满足$$C^T AC=C^{-1}AC$$

- 待续

另外这些特征值有功率的含义。

维纳滤波器自己要会推

维纳解$$w_0 =R^{-1}p$$

最小化目标函数时，误差信号与输入输出信号正交。如果均值为零就是不相关信号了。

- 在统计平均下，维纳滤波器的准则是滤波器输出与期望响应之间的误差的均方值最小。
- 最小均方误差准则得到的是具有相同统计特征的一类数据的最佳滤波器。
- 如果输入信号与期望响应联合平稳且各自平稳，所得的最佳滤波器为维纳滤波器。

## LMS算法

这里的排版比较乱，很多东西现在还没有想好应该怎么叙述才比较好，所以很多东西只是直接贴出来，以便以后排版。

我们采用维纳滤波器是为了最小化均方误差，凡是最小化均方误差的滤波器实际上都是维纳滤波器。但是维纳滤波器在实践上有几个不能实现的地方，例如

- 维纳滤波器采用的是均方误差，但是实际应用中我们根本得不到统计平均值，只能通过测量得到当前值。
- 无法计算统计平均，只能利用当前值，就需要使用估计值替代。涉及的量有相关矩阵和我们定义的向量$$p$$

$$
\begin{equation}
\begin{split}

\hat {\overrightarrow R}(k)=\overrightarrow x(k)\overrightarrow x^T(k)\\
\hat {\overrightarrow p}(k)=\overrightarrow d(k)\overrightarrow x(k)

\end{split}
\tag{9}
\end{equation}
$$

以当前次的估计值代替实际值。而我们采用的最陡下降法，计算时
$$
\begin{equation}
\begin{split}

w(k+1)=w(k)-\mu \hat g_w(k)

\end{split}
\tag{10}
\end{equation}
$$
按照梯度的反方向进行更新，每次更新步长为$$\mu$$。如果错误仍然定义为$$e=d-y\:$$这样的方式，则错误平方的梯度估计值可以写作
$$
\begin{equation}
\begin{split}

\hat g_w(k)=-2e(k)x(k)

\end{split}
\tag{11}
\end{equation}
$$
注意这个估计值是通过

