---
layout: post
comments: true
title:  "From Denoising to Compressed Sensing"
excerpt: "-"
date:   2019-05-09 12:42:24 +0000
categories: Notes
---

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
---

[TOC]

## 从降噪到压缩感知

### 摘要

降噪算法的目的是去除信号中的噪声、误差以及扰动等。在过去的几十年里，人们对相关算法做了广泛研究，结果是先进的降噪算法那可以有效地去除大规模加性高斯白噪声。压缩感知重建算法的目的是基于小数目的随机测量重建一个结构化信号。典型的压缩感知重建算法可以从有扰动的观测中迭代地估计一个信号。本文回答了一个自然的问题，即如何有效地在压缩感知重建中部署一个通用的降噪算法？为了回答这个问题，我们开发了一个近似消息传递（`Approximate Message Passing， AMP`）框架的扩展，叫做`Denoising-based AMP, D-AMP`，可以在迭代过程中继承大量的去噪器。

我们测试了，当与高性能去噪器一起使用的时候，我们的压缩感知算法能够提供目前最好的重建效果，而且速度比那些先进算法快几十倍。我们分析了一些理论原因来解释这些卓越性能的现象，这个的关键原因应当是算法中的去噪器在迭代中采用了合适的`Onsager`校正项，使得每一次迭代中，信号中的扰动非常近似高斯白噪声的分布，从而易于去除。

## I - 引入

### A. 压缩感知

压缩感知重建算法面对的基本挑战是，在小数量的测量下重建高维信号。压缩测量的过程可以被认为是线性映射，从长度为$$n$$的信号向量$$x_0$$映射到一个长度为$$m\ll n$$的测量向量$$y$$。由于这个过程是线性的，因此可以被建模为测量矩阵$$\boldsymbol \Phi \in \mathbb C^{m\times n}$$。这个矩阵可以采用各种物理解释，例如在压缩采样`MRI`中，这个矩阵可以是$$n\times n$$的傅里叶矩阵的采样行。在单像素相机中，这个矩阵可以是代表微镜阵列调制的序列。

往往信号$$x_0$$在某些变换域中是稀疏的，或者近似稀疏的，例如$$x_0=\boldsymbol \Psi u$$，其中$$\Psi$$是逆变换矩阵，$$u$$是变换域中稀疏信号。在这种条件下，我们将测量与转换集中到一个矩阵中$$\boldsymbol A=\boldsymbol \Phi\boldsymbol \Psi$$。当我们不采用稀疏性假设的时候，我们认为$$\boldsymbol A=\boldsymbol \Phi$$。在后文中我们的测量阵都采用$$\boldsymbol A$$来表示。

压缩感知重建问题是求解欠定方程组问题。原信号$$x_0$$经过测量后得到$$y=\boldsymbol Ax_0+\omega$$，压缩感知的问题就是根据得到的$$y$$计算$$x_0$$。由于$$m\ll n$$，所以这个问题是一个十分欠定的问题。因此还原信号的第一假设就是$$x_0$$是有特殊结构的信号，然后在满足$$y\approx \boldsymbol Ax$$的$$x$$搜索符合给定结构的解。对于$$x_0$$稀疏的条件下，一种常见的解法是凸优化问题
$$
\begin{equation}
\begin{split}
\underset{x}{argmin}\left \| x \right \|_1\\
&subject\: to \left \| y-Ax \right \|_2^2\leq\lambda
\end{split}
\tag{1}
\end{equation}
$$

这被称为基本追踪去噪`basis pursuit denoising, BPDN`，当$$x_0$$充分稀疏，且$$\boldsymbol A$$满足一些条件的时候，这种方法可以有效重建$$x_0$$

一开始人们也是用凸优化的方法解决压缩感知重建问题，然而档处理大信号的时候，例如图像信号，图优化算法计算复杂度就过高了。有关相关算法细节内容可以自己在参考文献中查询，本文可以从`IEEE Transactions on IF`找到。

### B. 主要贡献

稀疏模型对于许多信号来说已经十分精确了，而且已经是压缩感知领域的研究重点。遗憾的是，以稀疏假设为基础的方法对于图像来说应用并不好。原因大概是自然图像在任何已知的方法中并不具备精确的稀疏表达（即使是采用离散余弦变换、小波以及其他）。图像展示的是经典图像的小波变换的系数，显然是一个非稀疏的系数分布直方图。许多系数都是非零的，甚至有很多远离$$0$$的系数。因此寻求小波稀疏性的算法并不能恢复这个信号。

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/dfig1.jpg" style="display: inline-block;" width="500"/>
</div>

为了应对这样的失败，研究者提出了许多其他的压缩感知的重建描述模型。这些详细内容这里将不做介绍。本文中我们采用一种补充方法来增强非稀疏信号的压缩感知重建水平。相比关注于设计新的信号模型，我们测试了现有的去噪算法对压缩感知重建效果的增强。我们的想法很简单，信号去噪算法（无论是基于显式还是隐式模型）已经被设计并完善了数十年了，因此采用去噪算法的重建方案应当可以捕获迄今为止尚不能被现有压缩感知算法所捕获的结构。

`其实我觉得这个脑回路不行`

这里介绍`Approximate Message Passing, AMP`算法，近似消息传递算法，提供了一个自然的方法，在压缩感知重建中采用了去噪算法。我们称采用了`D`去噪器的`AMP`算法为`D-AMP`算法。`D-AMP`算法假设$$x_0$$属于一类信号$$C\subset \mathbb R^n$$，例如存在去噪器$$D_\sigma$$指定大小的自然图像类。每一个去噪器$$D_\sigma$$可以被应用于$$x_0+\sigma_z$$，其中$$z\sim N(0,I)$$，且可以返回一个估计值$$\hat x_0$$，（我们至少希望这张图）比之前的$$x_0+\sigma_z$$要更接近原图像。去噪器可以采用简单结构或其他复杂结构，将在后文讨论。本文中我们只是把每个去噪器看成是黑箱，他们收到叠加高斯白噪声的信号，然后返回对信号的估计。因此我们不考虑这个算法内部究竟是如何实现的。这是我们的推导适用于各种信号和各种去噪器。

上面所说，结合了去噪器的`AMP`算法有若干现有压缩感知重建算法所不具备的好处

- 很容易将一个算法部署到多种类型的信号问题上
- 比现有算法性能好，而且对测量噪声有很强的鲁棒性
- 带有一个描述框架，不仅可以知道算法的上限，还可以知道将来该如何选择

`D-AMP`算法如下迭代部署
$$
\begin{equation}
\begin{split}
x^{t+1}&=D_{\hat \sigma^t}(x^t+\boldsymbol A^*z^t) \\
z^t&=y-\boldsymbol Ax^t+z^{t-1}div D_{\hat \sigma^{t-1}}(x^{t-1}+A^*z^{t-1})/m\\
(\hat\sigma^t)^2&=\frac{\left\| z^t \right\|_2^2}{m}

\end{split}
\tag{2}
\end{equation}
$$
其中$$x^t$$是每次迭代中对$$x_0$$的估计，$$z^t$$则是对残差的估计。我们后面将推导出$$x^t+\boldsymbol A^*z^t=x_0+v^t$$，此处$$v^t$$可以看做是独立同分布的高斯噪声。$$\hat\sigma^t$$是噪声标准差估计，$$div D_{\hat \sigma^{t-1}}$$表示去噪器的散度（此处仅仅是偏导数的和），其中的$$z^{t-1}div D_{\hat \sigma^{t-1}}(x^{t-1}+A^*z^{t-1})/m$$就是所谓的`Onsager`修正项。我们将在后面展示这一项产生的性能影响。这个修正项的计算不是完全明确的，许多著名的去噪器并没有明确地计算公式，然而我们将证明这一项可以近似计算，而不用管究竟是什么形式的去噪器。

`D-AMP`将现有的去噪算法应用于压缩测量的向量。直觉上，每一次迭代中`D-AMP`将获得更好的估计结果，并且该估计序列最终是收敛于$$x_0$$的（无偏估计）。

为了预测`D-AMP`算法的性能，我们使用了一个新式的状态演化框架，在理论上跟踪算法每次迭代时的噪声和标准偏差$$\hat \sigma_t$$。我们的框架扩展并验证了前人文献中的框架，通过大量的仿真，我们证明了在高维场景中，我们的状态演化框架准确预测了算法的均方误差`MSE`。基于我们的状态演化，我们描述`D-AMP`算法性能，并将算法重建新号所需要的采样点数与降噪器的性能联系起来。我们还采用了状态演化去跟踪了微调去噪器参数的影响 以及 算法对测量噪声的敏感度。另外还用这个框架探索了算法的最优性。下图展示了一个示范结果，采用非去噪算法（利用小波域稀疏性）和去噪算法产生的不同。

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/dfig3.jpg" style="display: inline-block;" width="500"/>
</div>

### C. 相关工作

#### Approximate Message Passing and Extensions

近似消息传递及其扩展算法。

在过去的五年里，消息传递和近似消息传递算法在压缩感知中广泛研究的主题。许多已经发表的文章都采用了贝叶斯框架，这种框架中信号的先验概率$$p_x$$已经被定义在了信号$$x_0$$的分类`C`中了。消息传递算法被视为是一种计算后验均值$$\mathbb E(x_0\mid y,A)$$的方法。消息传递算法已经被简化为了近似消息传递算法，此处是利用了数据的高维度信息。状态演化框架已经被作为一种分析近似消息传递算法的方法提出。

我们的工作与上述不同之处在于，我们不对信号的先验做出任何假设，这将导致我们的状态演化框架出现不同，后面会详述差异。

值得一提的是，在开发`D-AMP`算法时我们不关心是否算法是否在指定的某个先验的条件下是否会接近某一个后验，也不在乎`D-AMP`算法中采用的去噪器是否与某个先验相关。相反，我们只关心一个重要因素，即$$x^t+\boldsymbol A^* z^t-x_0$$是否接近独立同分布高斯噪声。我们的分析是基于这个假设的，后面也会有仿真。

之前也有人做过类似的分析，在他们的假设中，去噪器`D`可以是任何满足尺度不变性的函数，我们的不同点在于

- 我们不对尺度不变性做要求，因为实际中很多去噪器都不满足这个
- 我们对方法与状态演化过程做了更加细致的验证
- 提出了算法参数调整原则
- 在算法中如何使用没有明确功能形式的去噪器
- 我们调查了算法的最优性

本文中提出的状态演化模型可以确实的跟踪算法的性能。

在本文完成时，另一篇关于如何在算法中部署去噪器的文章发表了，本文将进一步探索这个方法在压缩重建中的应用。

#### Model Based CS Imaging

许多研究者注意到了基于稀疏性算法的缺陷，也探索了其他的更为复杂的信号模型。这些模型可以通过约束解空间的方法显式执行，也可以采用惩罚函数的方法隐式地执行。

`2019-5-10 14:09:36`

算了这部分先不看了，直接去后面算了

## II - 基于去噪声的近似消息传递

我们考虑一族对于信号类别$$C$$的去噪算法$$D_\sigma$$。我们的目标是采用这些去噪器去从$$y=\boldsymbol Ax_0+w$$获取一个$$x_0\in C$$的良好估计（其中$$w\sim N(0,\sigma_x^2 I)$$）。我们从以下方法开始，这个方法是受到迭代硬阈值算法及其扩展形式在基于块的压缩图像的应用的启发。为了更好地理解这个算法，我们考虑无噪声条件下的$$y=\boldsymbol Ax_0$$，此时假设去噪器是一个投影（线性变换）。由$$y=\boldsymbol Ax$$和集合$$C$$定义的仿射子空间如图所示，我们假设$$x_0$$是唯一解，即二者交集的唯一元素。



<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/dfig4.jpg" style="display: inline-block;" width="500"/>
</div>
我们知道，解在投影子空间$$\{ x\mid y=\boldsymbol Ax \}$$，因此我们从$$x_0=0$$开始，向与子空间正交的方向移动，例如$$\boldsymbol A^*y$$。这个方向与子空间较为接近，但是却不一定是接近$$C$$的，于是，我们利用去噪（或者说投影）去获取一个估计来满足信号分类$$C$$的结构。整个原理就像图里所说的。




















