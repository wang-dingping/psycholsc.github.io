---
layout: post
comments: true
title:  "现代信号谱分析导论"
excerpt: "-"
date:   2019-03-13 16:42:24 +0000
categories: Notes
---

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
---

# 现代信号谱分析导论

## 先修课程

本课程需要的先修课程为

- 线性代数
- 信号与系统
- 数字信号处理
- 随机过程

此处不对该课程内容做出过多的介绍。

## 概述

我们日常看到的信号都是随机信号。在通信与雷达中，我们的接收信号永远是一个依某种概率分布的信号，我们要根据这个结果进行对结果的“猜测”，从而得到正确的结果。详细内容不多介绍。信号谱分析也是一个相似的学科。我们接收到的同类型信号往往是一个随机过程，我们永远不能获取该过程的所有实现`implementation`，但是我们在单次测量中一定能依一定精度获取一个随机序列。注意单次随机过程仍是一个连续过程，但是我们的测量却只能获取一个离散序列。当然，如果我们以奈奎斯特频率以上的频率进行采样（实际中往往都是过采样），则能获取其中的全部信息，并且能通过滤波器将其完全恢复。因此我们就可以

> 根据这一个随机过程的实现的片段，估计整个信号的功率谱分布。

不过这是我个人的总结，书中介绍为

> 根据观察到的样本数据集估计平稳信号的总体功率谱

实际上《现代信号谱分析》这本书就是讲解这一部分内容，这句话就是全书的中心思想。

对信号谱进行估计是一个很值得研究的学科，目前也有很多人对该方向进行研究。信号谱的分析一般分为两类方法，这也是本册课程后面会重点讲到的内容。一类是**经典谱估计方法**，另一类是**现代谱估计方法**。两类方法主要内容如下

- 非参数化方法（经典谱估计方法）

    依赖于傅里叶变换的方法，有**相关图**法、**周期图**法等。

- 参数化模型方法（现代谱估计法）

    依赖于现有模型的方法，建立一个含较多参数的模型，然后根据信号的特点对这些模型的参数进行估计，最后将模型直接转化为功率谱的形式。常见的有自回归方法、最大熵法、最大似然估计法、超分辨率法等。

## 谱分析基础

首先我们对功率谱进行一个简单定义。功率谱的本质应该是对整个随机过程的全部实现进行功率谱计算并求平均的方法，因为一个随机过程的实现很多，单次实现很可能并不能完整代表整个过程（当然有各态历经性这个性质，利用一次实现就可以估计整个随机过程的数字参数）。

那么功率谱密度的定义就是



$$
\begin{equation}
\begin{split}
P_x(\omega)=\sum\limits_{m=-\infty}^{+\infty}r_x(m)e^{-j\omega m}
\end{split}
\tag{1}
\end{equation}
$$


这个定义实质上是维纳辛钦定理的表达。这里对该定理不做证明，但是该定理揭示了随机过程的**自相关函数**与随机信号的**功率谱密度**是一对傅里叶变换对。对于从未接触过相关内容的人，此处对其性质做出一些解释

- 随机信号的自相关函数，由于本身信号是采样结果，因此我们认为相关函数也是离散形式的。但是由于做了一个离散时间傅里叶变换，这里根据傅里叶变换的性质，功率谱密度是一个连续量。

- 一般随机过程的自相关函数都是非周期的，不过也是存在例外的。如果我们的自相关**序列**（这里注释一下，对于离散的信号来说，自相关**序列**比自相关**函数**更加符合）是非周期的，那么此时一个重要的性质为

  
    $$
    \begin{equation}
    \begin{split}
    r(0)=\overline{P}=\int_{-\pi}^{+\pi}P(\omega)d\omega
    \end{split}
    \tag{2}
    \end{equation}
    $$
    即周期功率谱密度在一个周期内的积分。这个表达式不唯一，至于为什么是周期的，这个需要自己查《信号与系统》

- 随机信号的自相关函数和功率谱密度分别从**时域**和**频域**反映随机序列的**二阶统计特性**

---

一个平稳随机信号可以分解为两个互不相关的随机振幅简谐振动的叠加。如果是一个窄带过程，则可以表达为**莱斯形式**，否则我们可以将其叠加为



$$
\begin{equation}
\begin{split}
x[n]=\sum\limits_{k=1}^{N}(a_k \cos n\omega_k +b_k \sin n\omega_k)
\end{split}
\tag{3}
\end{equation}
$$


其中两个随机振幅是均值为$$0$$，方差为$$\sigma^2$$的高斯过程，联合平稳。

自相关函数保存了序列的全部频率成分，并且依能量的形式保存了振幅的信息。

---

## 统计估计基础

统计估计使信号处理中一个常用的手段，实际上专门有学科为**统计信号处理**。说明白一点，统计估计这部分的目的就是，如何更好地**用随机信号的一次样本实现的有限长数据估计统计特征量**。统计特征可以是均值、方差等，也可以是相关序列与谱等。实际上我们这里使用统计更多时候是评估谱估计方法的性能。

根据观测数据来推断某个量$$\theta$$的过程称为统计估计问题，设随机过程$$X(n)$$的某个数字特征量的真值为$$\theta$$，但是我们并不知道，只能根据已知的短暂的序列对这个参数进行估计，估计值一般记为$$\hat \theta$$。显然我们的估计值是根据序列$$x$$得到的，因此我们认为


$$
\begin{equation}
\begin{split}
\hat\theta=f(x)
\end{split}
\tag{4}
\end{equation}
$$



我们这里的函数$$f$$不仅可以是线性函数，也可以是其他非线性函数，为了衡量估计的近似程度，我们一般引入若干指标

- `bias`，即**偏差**。

  
    $$
    \begin{equation}
    \begin{split}
    bias[\hat\theta]=E\{ \hat\theta - \theta \}
    \end{split}
    \tag{5}
    \end{equation}
    $$
    若偏差为$$0$$，就是**无偏估计**，若在取样点数趋于无穷时偏差也趋于$$0$$，则被认为是**渐近无偏估计**。

- `var`，即**方差**

  
    $$
    \begin{equation}
    \begin{split}
    var[\hat\theta]=E \{ (\hat\theta - E\{\hat\theta\})^2 \}
    \end{split}
    \tag{6}
    \end{equation}
    $$
    样本方差我们学过很多次了，就是描述各次估计相对于估计均值的偏离程度。

- `mse`，即**均方误差**

    均方误差的定义为

    
    $$
    \begin{equation}
    \begin{split}
    mse[\hat\theta]=E\{(\hat\theta - \theta)^2\}=var[\theta]+(bias[\hat\theta])^2
    \end{split}
    \tag{7}
    \end{equation}
    $$
    如果均方误差是$$0$$，我们说这还是一个一致估计；如果均方误差在点数趋近于无穷的时候逼近$$0​$$，我们就说这是一个渐近一致估计。

---

接下来简单介绍一下相关参数的估计方法。

首先是我们关于**均值**的估计。对于一个因果稳定的系统，均值就是直接求和除以点数，这就是简单的求平均。需要注意期望与均值实际上不是相同含义，期望一般是统计意义上的平均，这时我们认为是对随机过程的所有实现进行统计；但是均值就是简单的求平均过程。

然后简单说以下**方差**的估计。这里的方差就是均值与实际数值之间差异的平方的平均值。由于样本有限，因此仍然是有限点数的平均结果。如果我们有


$$
\begin{equation}
\begin{split}
bias[\hat\sigma_X^2]=0
\end{split}
\tag{8}
\end{equation}
$$



我们就说这个方差的估计是$$\sigma_X^2$$的无偏一致估计。

对于自相关序列的估计，一般有两个方法。一种是


$$
\begin{equation}
\begin{split}
\hat r_x(m)=\frac{1}{N}\sum\limits_{n=0}^{N-1}x_N(n)x_N(n+m)
\end{split}
\tag{9}
\end{equation}
$$


这个估计是最常用的估计。因为点数是有限的，因此在位移求乘积并均值的过程中，不同位置求和的点数不同。例如在计算$$\hat r(0)$$的时候，我们是$$N$$个点计算，所以除以$$N$$是没有问题的；计算其他位置的时候，求和点数就会下降，但是此时我们仍然除以$$N$$，这就是这个方法估计的特点。

这里不加推导地说明，该估计是一个有偏估计，偏差为


$$
\begin{equation}
\begin{split}
bias[\hat r_x(m)]=-\frac{\mid m \mid}{N}r_x(m)
\end{split}
\tag{10}
\end{equation}
$$


这个估计是个有偏估计，但是随着取样点数$$N$$的增加，这个结果是渐近无偏估计。

对这个算法进行进一步的理解，我们可以发现，实际上这个估计就相当于给相关函数加了一个三角窗。

另外此算法的方差在$$N\to \infty$$的时候趋向于$$0$$，因此是一个渐近无偏**一致**估计。

另一种方法是


$$
\begin{equation}
\begin{split}
\hat r_x(m)=\frac{1}{N-\mid m \mid}\sum\limits_{n=0}^{N-1-\mid m \mid}x_N(n)x_N(n+\mid m\mid)
\end{split}
\tag{11}
\end{equation}
$$


这个方法的本质就是在处理均值的时候严格按照求和点数进行。这样可以保证所有的均值都是基于求和点数的，不会出现上述的加三角窗的情况，而且是一个**无偏一致估计**，但是当我们的$$m$$增大的时候，方差会远大于上一种方法。

> 实际上相关函数的估计，按照上述的两种方法来看，就是一个求平均的差异，参与平均的数据越多，靠近中心位置的估值就更加可靠，但是显然点数是有限的，因此估计的时候就会产生误差，这也就是功率谱估计的误差的来源。
>
> 另外这个自相关序列的估计还有一个要求，即DTFT为非负的。因为DTFT的结果是功率谱密度，功率谱密度不能出现负值。以上两种估计，虽然第一个相当于加了三角窗，但是功率谱确实非负的，因此实际中往往也使用这种。

---

### 功率谱及其估计

介绍完了基础理论，这里要开始介绍主要内容了。

确定性信号一般我们认为是能量信号，傅里叶变换就是信号的频谱特征。但是如果是随机信号就不一样了，一般我们认为随机信号是一个无限长信号，是一个功率信号，我们不能根据定义计算傅里叶变换，如果通过某种手段进行了计算，其“频谱”也是对功率的反映。

根据功率谱的定义，功率谱应该是需要计算无穷多的测量数据，实际上我们做不到，只能通过估计的方法尽可能地接近这个值。首先我们看一下**经典谱估计**方法。

### 经典谱估计（基于傅里叶变换）

经典方法嘛，大概是因为参数化方法还没有发展出来，人们就利用傅里叶方法进行近似了。根据维纳辛钦定理，我们可以知道


$$
\begin{equation}
\begin{split}
P_x(\omega)=\sum\limits_{m=-\infty}^{+\infty}r_x(m)e^{-j\omega m}
\end{split}
\tag{12}
\end{equation}
$$

$$
\begin{equation}
\begin{split}
r_x(m)=\frac{1}{2\pi}\int_{-\pi}^{+\pi}P_x(\omega)e^{j\omega m}d\omega
\end{split}
\tag{13}
\end{equation}
$$



不过一般来说功率谱的定义式我们还是采用


$$
\begin{equation}
\begin{split}
P_x(\omega)=&\lim\limits_{M\to \infty}E\left \{ \frac{1}{2M+1}\mid \sum\limits_{m=-M}^{+M}x(n)e^{-j\omega n} \mid^2 \right \}\\=&\lim\limits_{M\to \infty}E\left \{ \frac{\mid X(\omega) \mid^2}{2M+1} \right \}
\end{split}
\tag{14}
\end{equation}
$$


这个定义我们就可以看出，功率谱实际上是一个随机信号的无穷多次实现的截断频谱的统计平均。

### 周期图法（直接法）

周期图法是根据观察到的信号直接估计。最简单的估计式为


$$
\begin{equation}
\begin{split}
\hat P_{PER}(\omega)=\frac{1}{N}\mid X_N(\omega) \mid^2
\end{split}
\tag{15}
\end{equation}
$$


式中的截断频谱就是我们观测到的截断信号的`DTFT`。上式还可以写成离散形式（单位圆取样）


$$
\begin{equation}
\begin{split}
\hat P_{PER}(k)=\frac{1}{N}\mid X_N(k) \mid^2
\end{split}
\tag{16}
\end{equation}
$$


这种估计是渐近无偏的，由于其计算方法，实际上相当于是对功率谱加了三角窗。从方差来看，由于其方差并不随长度$$N$$增加而减小，因此我们认为该方法并不是一致估计方法。

### 相关图法（间接法）

首先估计相关函数，然后通过相关函数的方法进行谱分析。这个估计方法实际上就有些**参数化方法**的意思了。


$$
\begin{equation}
\begin{split}
\hat P_{BT}(\omega)=\sum\limits_{m=-M}^{+M}\hat r_M(m)e^{-j\omega m}
\end{split}
\tag{17}
\end{equation}
$$


这里用的自相关序列的估计值就是上述的第一种方法，虽然是一个有偏估计量，但是却可以处理为加窗的效果，在计算中可以简化。

这种方法的偏差与方差是一个`trade-off`问题，如果要使偏差小，就需要足够多的点数，此时窗函数的傅里叶变换才会接近$$\delta$$函数，但是此时方差又会增大，因此这种方法需要进行折中选择。

---

如果我们将原信号序列$$x_N(x)$$进行补零（补$$N$$个零），此时进行周期图法计算，得到的结果相当于$$N$$点的相关图。另一种角度我们可以认为是，用一个长度为$$2M+1$$的矩形窗函数截断最大长度为$$2N-1$$的$$\hat r$$。这个过程相当于给真实的自相关序列加了两个窗，其中矩形窗的作用类似于平滑处理，因此我们可以认为相关图法是周期图法的平滑改进。但是由于相关图法可以使用傅里叶变换快速实现，因此相关图法也更为常用。

### 经典谱估计方法小结

- 计算简单，可以用`FFT`方法加速运算，物理意义清晰。
- 谱分辨率低，不可避免的加窗会导致频谱泄漏。
- 方差大（谱的波动大）
    - 缺少均值和极限运算

针对上述缺点我们可以进行重点改进，例如使用其他窗函数进行截断，使得结果更加平滑。

> 在DSP课程中我们学过，窗函数的主瓣宽度主要决定谱的分辨力，而旁瓣决定谱的泄漏。一般我们会比较喜欢主瓣较窄而且旁瓣较低的窗函数，不过很遗憾这两个参数也是一对`trade-off`

- 平均周期图法
    - 对一个随机变量进行连续观测时，收集$$L$$组独立记录数据，可以将这些数据进行功率谱的平均处理，这样可以将方差降低。
- 窗函数法
    - 用一个适当的功率谱窗函数与周期图进行卷积，使得周期图平滑。前面采用的窗函数是三角窗和矩形窗，此处可以选择`Kaiser`窗或者`Blackman`窗等。
- 修正的周期图求平均法
    - 这里的方法是对长度为$$N$$的信号分成$$L$$段，然后将窗函数加到每一段数据中，求出每一段的周期图，形成修正的周期图，最后对周期图做平均处理。我操这要是数据量比较小的话得糊成啥样。
    - 实际上在分段的时候还可以出现重叠，例如做$$50\%$$的重叠

以上，无论以什么为代价总是以减少分辨率为代价换取估计方差的减小，提高分辨率的问题始终不能解决。

**那么提升分辨率应该怎么解决呢？**反正经典谱估计方法都是不能解决的。

参数化模型这里先不进行介绍。

## 非参数化方法

稍微详细地说明一下非参数化方法。前面说过非参数化方法的本质就是，通过傅里叶变换的方式对功率谱进行估计分析。

> 这里多一句嘴，一般说到**分析**就是积分。这也是为啥会出现那么多傅里叶分析的原因。

傅里叶变换的到的是频谱，通过平方操作就能得到功率谱。



## Multiple Emitter Location and Signal Parameter Estimation

这个是提供给我们的必读文献之一。1986年的古董。**还没完全看懂先把前面的部分翻译了**。

`2019-4-4 21:22:06`希望这几天先把前面的摘要看明白。这个稿子修修改改就是最后讲的稿子了。

首先这个算法被称为是`MUSIC`算法，其得名是**Mu**ltiple **Si**gnal **C**lassification。不得不说外国人还是很会起名的。这个算法的背景如下所述

在许多实际的信号处理问题中，我们的目标往往是根据测量结果估计接收信号所依赖的一组常数参数（这个应该说是参数化估计的目标）。为了解决估计问题，目前已经有一些成熟的算法，例如最大似然算法、`Burg`算法以及最大熵方法。虽然这些方法已经成功应用，但是它们有一些限制与不足，尤其是在参数估计中的偏差问题与灵敏度（分辨率）等问题。这主要是因为它们采用的模型并不完全正确，例如应该是用`ARMA`模型的地方为了各种原因而选择了`AR`模型。后面有人开发了利用数据的结构来进行估计的方法，例如使用协方差方法估计加性噪声中复杂正弦信号的参数。本文作者是第一个独立在任意形式的传感器阵列情况下正确利用了模型的人。他首先在没有噪声的条件下得到了完整的几何解，然后巧妙地扩展几何的概念在存在噪声的情况下获得合理的近似解来完成估计。这个算法就是`MUSIC`算法，至今为止已经被广泛研究。在目前公认的高分辨率算法中，`MUSIC`算法或许是最有前景的一种算法。不过虽然这个算法性能水平优异，但是却要占用大量的运算与存储资源。

简单地说，`MUSIC`算法采用的是本征空间方法估计信号或自相关矩阵的频域内容。对于一个指定阶数$$M$$的自相关矩阵的方阵，我们将特征值按从大到小排列，那么最大的$$p$$个特征值对应的特征向量应当是我们需要的信号，属于信号子空间；而对于剩余的$$M-p​$$个特征向量，就是上一个空间的正交子空间，我们认为这里只有噪声。下面我们**复读一下论文的内容**。

> 阅读此文章需要一定的线性代数知识基础，大一我们学的线性代数实在是有些naive，读这篇文章根本读不懂。

### Abstract

处理传感器阵列接收的发射机信号在很多估计用途中都十分重要，也被广泛关注了。一般的问题都是考虑在任意协方差矩阵的噪声/干扰环境中有任意位置和任意方向特性的的传感器，本文则是首先考虑了多个发射机的该类问题，然后考虑了这种问题的通用解。这里提出的算法是`MUSIC, multiple signal classification`算法提供了以下参数的渐近无偏估计方法

- 入射波前数的。*波阵面是波在介质中传播的时候，经历相同时间所达到的各点所连成的直线、曲线或曲面，最前面的那一个面被称为波前。这里强调波前可能是因为考虑到了波阵面上相位相同*
- 发射机位置。
- 波形的强度和不同波形之间的互相关。
- 噪声、干扰强度。

此处对比了最大似然估计方法以及最大熵法，以及一些其他的实例，会在后面介绍。

### Intro

术语`MUSIC`用于描述涉及根据在阵列元件处接收的信号进行的测量来确定作为天线阵列到达的多个波前的参数所涉及的实验和理论技术。

> MUSIC就是一种根据测量到的接收信号确定天线阵列到达的多个波的参数的技术，可以用于理论分析也可以用于实践指导。

一般的问题涉及天线，这些天线可以有任意位置与任意方向特征且在含噪（或干扰）环境下有着任意的协方差矩阵。按照上面的描述，`MUSIC`算法可以提供下列参数的渐近无偏估计

- 信号数量
- 信号方向
- 不同方向波形的强度及其互相关
- 极化
- 干扰或噪声的强度

这个方法十分普适，典型应用有

- 传统干涉测量法
- 单脉冲方向搜索
- 多频率估计

> 这一段英语说得太拧巴了，用白话说一遍下面这段
>
> `MUSIC`这个词是一种算法的缩写，这种算法是用来进行信号处理的，具体是对于阵列接收到的波前信息进行处理的，主要用于接收参数估计信号谱的。
>
> 一般问题都是考虑一个任意位置任意方向性（方向性指增益、相位与极化等）的天线系统，这个系统是在一个有干扰和噪声的环境中的，并且有任意的协方差矩阵（协方差矩阵往往是提供功率与相关性等信息）。这个算法也是在这种假设下进行的，它可以提供如下的估计
>
> 1. 信号数量
> 2. 信号方向
> 3. 不同方向波形信号强度和协方差矩阵
> 4. 极化
> 5. 干扰和噪声强度
>
> `MUSIC`算法的一些典型应用场景是
>
> 1. 传统干涉测量
> 2. 单脉冲测向（DF），例如采用多共置天线
> 3. 多频率估计



### Data Model

`M`个阵列单元接收到的波形是由`D`个事件波前以及噪声线性组合而成的。因此我们认为结构可以描述为
$$
\begin{equation}
\begin{split}
\left[ \begin{matrix}X_1\\X_2\\...\\...\\X_M\end{matrix} \right]=\left[ \begin{matrix} \\ \\ a(\theta_1) & a(\theta_2)&...&a(\theta_D)\\ \\ \\ \end{matrix} \right]\left[ \begin{matrix}F_1\\F_2\\...\\...\\F_D\end{matrix} \right]+\left[ \begin{matrix}W_1\\W_2\\...\\...\\W_M\end{matrix} \right]
\end{split}
\tag{2.1}
\end{equation}
$$


或者可以简写为
$$
\begin{equation}
\begin{split}
&X&=&A&F+&W\\ RP: \\
&X(t)&=&A(\theta)&F(t)+&W(t)
\end{split}
\tag{2.2}
\end{equation}
$$
> 这个人用的符号好奇怪啊
>
> 这里表示的意思就是，我们有$$M$$个阵元，接收到了$$M$$个信号$$\boldsymbol X$$，这些测量到的值可以表示为上述形式，$$A$$是导向矩阵，$$F$$是信号源（参考点）的信号，$$W$$用来表示噪声（噪声是所有噪声源的等效噪声，例如测量噪声、信道噪声、设备内部噪声等）。注意以上的所有矩阵都是复数矩阵，这样更有代表性。
>
> 矩阵$$A$$中的元素可以表示为$$a_{ij}$$，是信号抵达角和阵元位置的函数。我们有$$D$$个信号从参考点发出，这个数量要小于$$M$$个阵元的数量，此时$$A$$矩阵也有$$D$$列，$$M$$行。$$A$$从物理意义角度来看，其每一行$$a_i$$取决于阵元 $$i$$，位置相对原点，每一列代表对$$j$$个信号入射方向入射的信号的响应。所以结果就相当于每一个阵元对每一个信号的测量结果的加权。
>
> $$A$$矩阵的第$$j$$列是一个模式向量$$a(\theta_j)$$，是对第$$j$$个信号到达角$$\theta_j$$的响应。知道了模式向量$$a(\theta_1)$$就相当于知道了$$\theta_1$$。（这里要求$$\theta_1$$和$$a(\theta_1)$$是一一对应的函数关系）

在几何语言中，可以将测量的$$X$$矢量可视化为$$M$$维空间中的矢量。这样$$A$$实际上是一个变换矩阵，将参考点信号映射到了测量点的值，这样就可以简单可视化这个结果。第一个等式说明$$\boldsymbol X$$是模式矢量的特定线性组合，$$F$$中的元素就是组合的系数。注意，$$\boldsymbol X$$是被限制在$$A$$的范围空间内的。如果$$A$$有两列，则$$\boldsymbol X$$就必然位于$$M$$维空间内的二维子空间内。另一点需要注意的是，$$a(\theta)$$是一个连续函数，在$$M$$维空间内，但是是非常非线性的。如果想要尝试理解这个可视化原理，我们可以参考这张图

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig1.png" style="display: inline-block;" width="600"/>
</div>

> 这张图给出的是三天线的场景，三天线系统中，我们测量到的三个信号就是$$X_1,X_2,X_3$$，在途中也有这三个信号，分别为三条虚线。
>
> 其中$$e$$向量分别是对应于特征值$$\lambda$$的特征向量，对于较大特征值，对应的特征向量就张成了信号子空间（如图所示的二维空间），对于较小的特征值，对应的就是噪声子空间（如图所示的一维向量）。从图中可以直观看出来，信号子空间与噪声子空间是相互正交的，这只是人类能够接受的最高维的情况的，对于更为高级的维度，就不能在这里可视化展示了。我们接下来需要做的就是证明这个理论的正确性。
>
> 图中还有俩向量在信号子空间内，这两个正是信号的模式向量。下面会证明这个模式向量是与噪声子空间正交的。


三个以$$e$$命名的向量分别是信号与噪声的归一化**特征向量**。此时我们的假设是，在仅方位角测向系统中，$$\theta$$将是单一参数构成的（也就是方向角）。当然如果在一个方向角、仰角、距离系统中，这个$$\theta$$就由这三个参数构成。无论在什么情况下，$$a(\theta)$$都是一个连续型矢量函数，扭曲缠绕在$$M$$维空间中。

在这些几何术语中，解决多个入射波前的到达方向的问题包括定位$$a(\theta)$$连续矢量函数与距离空间$$A​$$相交点。

$$A$$的距离空间是从测试数据中获得的。接下来是获取这个距离空间及其维度的方法。

其实这里的`range space`一词还不知道具体指什么。

### The S Matrix

也不知道是谁引入的这种叫法，实际上就是相关矩阵。
$$
\begin{equation}
\begin{split}
S=\overline{XX^*}=A\overline{FF^*}A^*+\overline{WW^*}
\end{split}
\tag{2.3}
\end{equation}
$$
或者说我们写作
$$
\begin{equation}
\begin{split}
S=APA^*+\lambda S_0
\end{split}
\tag{2.4}
\end{equation}
$$

> 至于为啥这么写我们下面慢慢看

我们的基础假设是，参考源发出的信号与噪声信号是不相关的。注意信号的波前矩阵$$F$$中的元素（即波前）可能是相互之间不相关或者完全相关的（这时候矩阵$$P$$就是一个奇异矩阵）。总的来说，$$P$$矩阵应该是正定的，反映了入射波形之间成对相关的程度（相关性，不相关就是$$0$$，相关就是大于$$0$$）。

> 奇异矩阵，非满秩矩阵。这是一个针对方阵的说法。奇异矩阵行列式为$$0$$

当不同波前的数量$$D​$$少于阵元数$$M​$$的时候，$$APA^*​$$是奇异矩阵。它的秩不满，那么就有行列式为$$0​$$。根据$$(2.4)​$$的等式关系，我们可以得到$$\mid S-\lambda S_0 \mid = 0​$$这样的结论。这个结论的条件是，$$\lambda​$$等于$$S_0​$$的度量中$$S​$$的一个特征值。类比一下$$\mid S-\lambda I\mid=0​$$的条件是$$\lambda​$$等于$$I​$$的度量中$$S​$$的一个特征值。不过在$$A​$$满秩且$$P​$$正定的条件下，$$APA^*​$$一定是非负定的，因此这个式子成立的条件只能是$$\lambda=\lambda_{min}​$$。
$$
\begin{equation}
\begin{split}
S=APA^*+\lambda_{min} S_0\:,\:\lambda_{min}\geq 0
\end{split}
\tag{2.5}
\end{equation}
$$
注释一下，$$\lambda_{min}$$是$$\mid S-\lambda S_0 \mid = 0$$的最小值解。以上都是针对特殊情况的，如果噪声向量均为零均值，$$\sigma^2$$方差的，那么$$\lambda_{min}S_0=\sigma^2 I$$。

### Calculating a Solution

上面乱七八糟说了很多，坑也开了很多，现在我们来求解。

$$APA^*$$的秩为$$D$$，可以从$$S$$在$$S_0$$度量下的特征值中直接确定。在理想情况下，我们认为特征值有功率的含义，此时噪声功率倘若都认为是相同，那么最小特征值将被认为是噪声的特征值。如果我们发现最小特征式重复了$$N$$次，那么对信号数量的估计就是
$$
\begin{equation}
\begin{split}
\hat D=M-\hat N
\end{split}
\tag{2.6}
\end{equation}
$$
由于在我们的假设中，信号的数量是不超过阵元的数量的，那么分解以后的$$APA^*$$只代表信号部分，此时最小特征值一定为$$0$$。而分解出去的噪声部分，一定是补全这一部分的。这里说的$$\hat N$$就是$$\lambda_{min}$$的重复次数。（不过从实际操作的角度来讲，这个值的出现一定不是一个固定值，而是若干个不同的值，在某一个范围内分布，毕竟估计值与理论值相比有一定误差）

### The Signal and Noise Subspaces

信号与噪声子空间。这一段开始胡说八道。

$$S$$在$$S_0$$度量下的$$M$$个特征向量一定满足$$Se_i=\lambda_i S_0 e_i$$这个关系，其中$$e_i$$就是特征向量。

>这个说法源头是线性代数中的一种简化表达
>
>$$Ax=\lambda x$$
>
>此时$$\lambda$$是特征值，$$x$$是对应的特征向量，可以组成列向量矩阵。
>
>这里修改了度量，将原来的$$I$$度量修改为了$$S_0$$度量，是为了应对特殊情况。对于简单的白噪声情况，仍然是以$$I$$为度量。

那么将这个关系带入到上面的表达式中我们会得到$$APA^* e_i=(\lambda_i-\lambda_{min})S_0 e_i$$。显然当任意一个$$\lambda_i$$取值为$$\lambda_{min}$$的时候，上式右侧就是$$0$$。如果考虑到$$P$$是个正定的矩阵，那么只能得到$$A^*e_i=0$$

还记得$$A$$矩阵是导向矩阵，是由阵元特性决定的。这个结果说明了$$\lambda_{min}$$所关联的特征向量与空间导向矩阵$$A​$$的列向量是相互正交的。作者在这里给画了一个叹号，以示发现惊人

<div style="text-align:center"><img alt="" src="https://raw.githubusercontent.com/psycholsc/psycholsc.github.io/master/assets/MUSICFig.png" style="display: inline-block;" width="500"/>
</div>
那么因此我们可以合理地将$$N$$个噪声特征向量跨越的$$N$$维子空间称为噪声子空间，并将由入射信号模式向量跨越的$$D$$维子空间称为信号子空间，他们是正交的。

> 咱们回来理一下，为什么这个地方作者会用叹号来说。到目前为止作者都在推导一个是，那就是信号子空间和噪声子空间的正交性问题，如果符合这一点，那么就可以继续采用下面的算法进行计算了。首先确定什么是信号子空间，什么是噪声子空间。结合上面的图片我们可以看到，子空间是通过特征向量来定义的，这里我们看一下同济大学线性代数的资料。
>
> 线性空间的含义如下。
>
> 线性空间也叫向量空间，是线性代数的中心内容之一。线性空间是可以人为定义的，只要满足了特定要求，都可以被称为是线性空间，具体需要满足的关系可以查线性代数的课本（实际上是加法与乘法）。满足了这个运算关系的集合就可以被称为是一个线性空间，对于这个集合的一个子集，如果上述运算关系也都满足，且封闭，并且包含零向量，那么就说这个子集是原线性空间的子空间。
>
> 那么子空间应当是原空间中自洽的一个闭合空间。子空间有几个运算需要解释
>
> 对于一个向量集合，包含它的最小子空间就成为这一组向量的**扩张**，记作$$span(B)$$
>
> 对于上述向量集合，如果他的扩张是向量空间$$V$$，那么原向量集合就被称为是**生成集合**
>
> 对于上述向量集合，如果是线性无关的，且可以生成$$V$$，那么他就是$$V$$的一个基
>
> 然后我们来找找文章中的信号子空间。
>
> 信号子空间就是大特征值对应的特征向量张成的子空间，而噪声子空间就是若干较小特征值张成的子空间。通过上述证明我们已经发现，这两个子空间是相互垂直的。
>
> 作者到这里的时候显然完成了本文中最重要的证明之一，故采用叹号进行说明。

### The Algorithm

我们现在就有办法解决信号模式向量的问题了。如果$$E_N$$定义为$$M\times N$$的向量，$$N$$列分别为噪声特征向量，那么任意一个向量$$Y$$到这个空间的欧几里得距离（的平方）可以定义为$$d^2=Y^*E_NE_N^*Y$$，那么我们可以认为
$$
\begin{equation}
\begin{split}
P_{MUSIC}(\theta)=\frac{1}{a^*(\theta)E_NE_N^*a(\theta)}
\end{split}
\tag{2.7}
\end{equation}
$$

可以看出，即使是对于多个入射信号而言，`MUSIC`的估计也是渐近无偏的，因为$$S$$矩阵是渐近完美地测量，因此从此得出的$$E_N$$也是。$$a(\theta)$$则不依赖于任何测量数据。

一旦`D`个入射信号的方向角被找到了，$$A$$矩阵就是可用的并且可以用来计算各个信号的参数了。$$P$$矩阵的解析解可以表示为
$$
\begin{equation}
\begin{split}
P=(A^*A)^{-1}A^*(S-\lambda_{min}S_0)A(A^*A)^{-1}
\end{split}
\tag{2.8}
\end{equation}
$$

> 一般意义上的MUSIC算法到这里就应该是结束了，但是这里从论文的角度来看还有半篇，本次课题也是读论文为主，因此我们计划把整篇论文都整完。

### Including Polarization

极化问题，这里我就不是很懂了。上面说到，此时我们已经知道了$$A$$矩阵，可以用这个矩阵来估计信号的参数了。实际上我觉得可以翻译成偏振问题。

那么考虑一个信号，它从一个特定方向$$\theta_0$$来。假定阵元的极化相同，例如都是垂直计划。显然方向定位系统是对垂直极化能量最为敏感，而对水平极化的能量完全不敏感，对其他极化的垂直分量较为敏感。

对于一般阵列（即极化方向不同的阵列），对应于方向$$\theta_0$$的模式矢量取决于信号的极化。垂直极化信号将引起一种模式矢量，但是水平极化会引发另一种，右手圆极化也是另一种。

信号的极化可以被一个复数$$q$$来表示。我们可以观测当信号的极化参数$$q$$改变的时候（发射机方位角改变的时候），模式向量如何发生改变。可以证明，当极化参数$$q$$遍历了所有变化之后，模式矢量会扫出一个二维的极化子空间。因此仅需要两个独立的模式向量张成极化子空间就能表示$$\theta_0$$位置信号的任意极化方式了。实际的体现是，仅需要计算或保持两个发射极偏振的模式矢量以存储方向θ，以便求解发射极化，其中在具有非极化多样化的阵列的系统中仅需要一个来解决DOA。

这些论证导致类似于$$(2.7)$$的$$P(\theta)​$$表达式，不过这个表达式里面需要考虑不同阵元的极化影响。

$$
\begin{equation}
\begin{split}
P_{MUSIC}(\theta)=\frac{1}{\lambda_{min}\left(\left[\begin{matrix} a_x^*(\theta)\\a_y^*(\theta) \end{matrix}\right]E_NE_N^*\left[\begin{matrix} a_x(\theta)&a_y(\theta) \end{matrix}\right]\right)}
\end{split}
\tag{2.9}
\end{equation}
$$
其中ax（θ）和ay（θ）是对应于例如分别取x和y线性入射波前偏振的两个连续函数。对应于（8）中的λ_min的特征向量提供极化参数q，因为它具有$$\left[\begin{matrix}1&q\end{matrix}\right]^T$$的形式。